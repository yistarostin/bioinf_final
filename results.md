# Результаты


Код представлен ссылками на тетрадки и файлами ipynb, файлы с результатами лежат в папке `files_new`.
Добавить сам геном в репозиторий не получилось из-за ограничения на размер файла.


## Анализ различных семейств и поиск генов

Код, при помощи которого я выполнял данное задание: https://colab.research.google.com/drive/1kc2iYErxWlaw0SjYuZ1m-uAmQY4aG0q5?usp=sharing

Мною была использована программа hmmer. В данную таблицу я поместил только часть генов, остальные есть непосредственно в выводе программы в тетрадке.

| Проверяемое семейство | Название гена |
|-----------------------|---------------|
| PAK2 (PF05028)        | LOC126570243  |
| PRMT7 (PF06325)       | LOC126576335  |
| PRDM2 (PF00856)       | LOC126571906  |
| PRMT9 (PF13414)       | LOC126581796  |
| PRKAA1 (PF00069)      | LOC126574753  |
| PRDM4 (PF00096)       | LOC126576043  |
| PPM1G (PF00076)       | LOC126577504  |
| SMARCD1 (PF02201)     | LOC126574654  |
| SPEN (PF13893)        | LOC126571025  |
| TAF5 (PF00400)        | LOC126573068  |


## Анализ попаданий Zhunt, ZDNABERT и поиска квадруплексов

Для выполнения задания я локально запускал программу zhunt на процессоре ноутбука, а ZDNABERT использовал в облаке с видеокартой.

Для развертывания ZDNABERT мною была выбрана следующая тетрадка с примерами работы: https://github.com/mitiau/Z-DNABERT/blob/main/ZDNA-prediction.ipynb

Мне не удалось загрузить в репозиторий результат zhunt из-за большого веса файла (144 мегабайт), я загрузил его в облако. Файл с результатом работы ZDNABERT был разгружен в репозитории под названием `text_predictions.txt`.

Файл с результатом поиска квадруплексов через регулярные выражения -- `quadruplexes.bed`.

В репозитории есть bed-файлы результатом zhunt и zdnabert, которые я использовал непосредственно для поиска пересечений через `bedtools intersect`

Мой код для выполнения задания: https://colab.research.google.com/drive/1QXdqqOTqYINr25O0hBCY2zwKZa8-vvGN?usp=sharing

### Таблица 1, количества попаданий
| Участок                      | Число квадруплексов | Доля квадруплексов | Число предсказаний Zhun | Доля предсказаний Zhun | Число предсказаний ZDNABERT | Доля предсказаний ZDNABERT |
|------------------------------|---------------------|--------------------|-------------------------|------------------------|-----------------------------|----------------------------|
| Exons                        | 1686                | 0.065              | 62387                   | 0.38                   | 19282                       | 0.50                       |
| Introns                      | 7497                | 0.29               | 76369                   | 0.46                   | 15707                       | 0.41                       |
| Promoters (1000 up from TSS) | 574                 | 0.02               | 9093                    | 0.05                   | 3262                        | 0.08                       |
| Downstream (200 bp)          | 186                 | 0.007              | 1985                    | 0.01                   | 353                         | 0.009                      |
| Intergenic                   | 9864                | 0.38               | 48085                   | 0.29                   | 13993                       | 0.36                       |
|                              |                     |                    |                         |                        |                             |                            |

### Таблица 2, количества участков с попаданиями


| Участок                      | Число участков с  квадруплексом | Доля участков с предсказанным квадруплексом | Число участков с предсказаниями Zhunt | Число участков с предсказаниями Zhunt | Число участков с предсказаниями ZDNABERT | Доля участков с предсказаниями ZDNABERT |
|------------------------------|---------------------------------|---------------------------------------------|---------------------------------------|---------------------------------------|------------------------------------------|-----------------------------------------|
| Exons                        | 1686                            | 0.065                                       | 16882                                 | 0.10                                  | 4927                                     | 0.13                                    |
| Introns                      | 7411                            | 0.29                                        | 12797                                 | 0.07                                  | 2913                                     | 0.07                                    |
| Promoters (1000 up from TSS) | 574                             | 0.02                                        | 5657                                  | 0.03                                  | 2166                                     | 0.05                                    |
| Downstream (200 bp)          | 186                             | 0.007                                       | 1771                                  | 0.01                                  | 325                                      | 0.008                                   |
| Intergenic                   | 9864                            | 0.38                                        | 4451                                  | 0.027                                 | 1742                                     | 0.05                                    |
|                              |                                 |                                             |                                       |                                       |                                          |                                         |

Я получил фон, посчитав отношения длины найденных участков к длине всего генома, получились следующие значения:

* Квадруплексы: `0.0034`
* Предсказания Zhunt: `0.0255`
* Предсказания ZDNABERT: `0.00366`

Видим, что для ZDNABERT получились довольно странные результаты, так как сумма долей получилась больше 1, хотя участки не могли пересекаться. При этом у ZDNABERT наименьший фон, то есть эти предсказания более точные и меньше допускают ошибку типа false-positive. Zhunt оказался более точным и нашел наибольшее число предсказаний, в среднем в несколько раз больше результата ZDNABERT, то есть полнота у Zhunt выше. Это можно объяснить тем, что Zhunt выполняет полный поиск по всему файлу, в то время как ZDNABERT использует вероятностый подход и априори подвержен ошибке неточности
